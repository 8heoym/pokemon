# 📋 Phase 2: 동기부여 시스템 - 테스트 시나리오

## 🎯 테스트 목표
- **Streak System (연속 학습)**: 일일 활동 추적 및 연속 기록 관리
- **Star Dust System (별의모래)**: 가상 화폐 시스템 및 거래 기록
- **Badge Case & Shop**: 배지 수집 및 상점 구매 시스템
- **Enhanced Visual Feedback**: 애니메이션 및 사용자 경험 개선
- **API Integration**: 백엔드 동기부여 시스템과의 연동

## 📊 테스트 매트릭스

### 1. Streak System 테스트

#### 1.1 일일 연속 기록 테스트
**시나리오 ID:** TC-P2-001  
**목적:** 연속 학습 기록 정확한 추적 확인

**전제조건:** 
- 서버 실행 중 (localhost:3001, localhost:3000)
- 새로운 테스트 사용자 생성

**테스트 단계:**
1. 새 사용자 생성 → 연속 기록 0일 확인
2. 문제 1개 풀이 → 연속 기록 1일로 증가 확인
3. 하루 뒤 문제 풀이 → 연속 기록 2일로 증가 확인
4. 2일 뒤 문제 풀이 → 연속 기록 1일로 초기화 확인

**예상 결과:**
- ✅ 일일 활동 시 연속 기록 증가
- ✅ 하루 건너뛸 시 연속 기록 초기화
- ✅ 최장 기록 별도 저장
- ✅ StreakDisplay 컴포넌트에 정확한 정보 표시

#### 1.2 스트릭 보너스 시스템 테스트
**시나리오 ID:** TC-P2-002  
**목적:** 연속 학습에 따른 보너스 적용 확인

**테스트 데이터:**
```json
{
  "user": {
    "currentStreak": 7,
    "starDust": 100
  }
}
```

**테스트 단계:**
1. 7일 연속 사용자로 문제 풀이
2. 별의모래 획득량에 스트릭 보너스 적용 확인
3. 14일, 30일 연속 시 보너스 배수 변화 확인

**예상 결과:**
- ✅ 3일: +20% 보너스
- ✅ 7일: +50% 보너스  
- ✅ 14일: +100% 보너스
- ✅ 30일: +150% 보너스

#### 1.3 일일 보너스 시스템 테스트
**시나리오 ID:** TC-P2-003  
**목적:** 일일 보너스 지급 및 중복 방지 확인

**테스트 단계:**
1. 일일 보너스 버튼 클릭
2. 별의모래 및 경험치 지급 확인
3. 같은 날 재클릭 시 오류 메시지 확인
4. 다음 날 다시 클릭 시 정상 지급 확인

**예상 결과:**
- ✅ 일일 보너스 1회 제한
- ✅ 연속일수에 따른 보너스 배수 적용
- ✅ UI에서 버튼 비활성화 처리

### 2. Star Dust System 테스트

#### 2.1 별의모래 획득 테스트
**시나리오 ID:** TC-P2-004  
**목적:** 문제 풀이 시 별의모래 정확한 지급 확인

**테스트 단계:**
1. 기본 정답 시 별의모래 10개 획득 확인
2. 힌트 없이 첫 시도 정답 시 15개 획득 확인
3. 연속 학습 보너스 적용 확인
4. StarDustDisplay 애니메이션 확인

**예상 결과:**
- ✅ 정답 시 10~15개 기본 지급
- ✅ 스트릭 보너스 정확한 계산
- ✅ 애니메이션 효과 정상 동작
- ✅ 사용자 starDust 필드 업데이트

#### 2.2 거래 기록 시스템 테스트
**시나리오 ID:** TC-P2-005  
**목적:** 별의모래 거래 내역 추적 확인

**테스트 단계:**
1. 문제 풀이로 별의모래 획득
2. 상점에서 아이템 구매
3. 거래 기록 API 조회
4. 수입/지출 내역 정확성 확인

**예상 결과:**
- ✅ 모든 거래 내역 기록
- ✅ 타입별 분류 (earned/spent)
- ✅ 소스별 분류 (problem_correct, shop_purchase 등)
- ✅ 타임스탬프 정확성

### 3. Badge System 테스트

#### 3.1 배지 자동 획득 테스트
**시나리오 ID:** TC-P2-006  
**목적:** 조건 달성 시 배지 자동 지급 확인

**테스트 시나리오:**
```
- 첫 문제 풀이 → "첫 걸음" 배지
- 2단 완료 → "2단 마스터" 배지  
- 30일 연속 → "끈기의 상징" 배지
- 100마리 수집 → "포켓몬 컬렉터" 배지
```

**테스트 단계:**
1. 각 조건 달성
2. 배지 자동 지급 확인
3. BadgeCase에서 배지 표시 확인
4. 중복 지급 방지 확인

**예상 결과:**
- ✅ 조건 달성 시 즉시 배지 지급
- ✅ 중복 지급 방지
- ✅ BadgeCase UI 정확한 표시
- ✅ 획득 날짜 기록

#### 3.2 배지 케이스 UI 테스트
**시나리오 ID:** TC-P2-007  
**목적:** 배지 케이스 모달 기능 확인

**테스트 단계:**
1. 배지 버튼 클릭 → BadgeCase 모달 열림
2. 카테고리별 필터링 동작 확인
3. 획득/미획득 배지 시각적 구분 확인
4. 진행도 바 정확성 확인

**예상 결과:**
- ✅ 모달 정상 열림/닫힘
- ✅ 카테고리 필터 동작
- ✅ 획득 배지는 컬러풀, 미획득은 그레이스케일
- ✅ 전체 진행도 정확한 계산

### 4. Shop System 테스트

#### 4.1 상점 아이템 표시 테스트
**시나리오 ID:** TC-P2-008  
**목적:** 사용자별 맞춤 상점 아이템 표시 확인

**테스트 데이터:**
```json
{
  "user": {
    "trainerLevel": 3,
    "currentStreak": 5,
    "starDust": 800,
    "completedTables": [2, 3],
    "purchasedItems": ["experience_boost"]
  }
}
```

**테스트 단계:**
1. 상점 버튼 클릭 → BadgeShop 모달 열림
2. 레벨/조건 부족 아이템 비활성화 확인
3. 별의모래 부족 아이템 표시 확인
4. 이미 구매한 아이템 '구매완료' 표시

**예상 결과:**
- ✅ 조건 미달성 아이템 🔒 표시
- ✅ 별의모래 부족 아이템 비활성화
- ✅ 구매 완료 아이템 체크 표시
- ✅ 구매 가능 아이템만 활성화

#### 4.2 아이템 구매 프로세스 테스트
**시나리오 ID:** TC-P2-009  
**목적:** 상점 아이템 구매 전체 플로우 확인

**테스트 단계:**
1. 구매 가능한 아이템 선택 및 구매
2. 별의모래 차감 확인
3. purchasedItems 배열 업데이트 확인
4. UI 상태 변경 확인

**예상 결과:**
- ✅ 구매 시 별의모래 정확한 차감
- ✅ 사용자 데이터 즉시 업데이트
- ✅ 구매 버튼 → '구매완료' 상태 변경
- ✅ 성공/실패 메시지 표시

#### 4.3 구매 조건 검증 테스트
**시나리오 ID:** TC-P2-010  
**목적:** 구매 시 각종 조건 검증 확인

**테스트 케이스:**
- 별의모래 부족 시 구매 시도
- 이미 구매한 아이템 재구매 시도
- 조건 미달성 아이템 구매 시도

**예상 결과:**
- ✅ 각 조건별 적절한 오류 메시지
- ✅ 부정한 구매 시도 차단
- ✅ 사용자 친화적 오류 표시

### 5. Enhanced Visual Feedback 테스트

#### 5.1 애니메이션 시스템 테스트
**시나리오 ID:** TC-P2-011  
**목적:** 동기부여 관련 애니메이션 동작 확인

**테스트 요소:**
- StreakDisplay 불꽃 애니메이션
- StarDustDisplay 반짝임 효과
- 별의모래 획득 시 +숫자 팝업
- 배지 케이스의 NEW 배지 알림

**예상 결과:**
- ✅ 모든 애니메이션 60fps 부드러움
- ✅ 메모리 누수 없음
- ✅ 사용자 경험 향상 효과

#### 5.2 반응형 디자인 테스트
**시나리오 ID:** TC-P2-012  
**목적:** 모바일/태블릿에서 동기부여 UI 확인

**테스트 해상도:**
- 모바일: 375x667
- 태블릿: 768x1024  
- 데스크톱: 1920x1080

**예상 결과:**
- ✅ 모든 해상도에서 UI 깨짐 없음
- ✅ 터치 인터랙션 정상 동작
- ✅ 텍스트 가독성 유지

### 6. API Integration 테스트

#### 6.1 동기부여 API 통합 테스트
**시나리오 ID:** TC-P2-013  
**목적:** 프론트엔드-백엔드 동기부여 API 연동 확인

**테스트 API 엔드포인트:**
- `POST /api/users/:userId/streak`
- `POST /api/users/:userId/stardust`
- `GET /api/users/:userId/shop`
- `POST /api/users/:userId/purchase`
- `GET /api/users/:userId/motivation-stats`

**테스트 단계:**
1. 각 엔드포인트 정상 응답 확인
2. 데이터 형식 검증
3. 오류 처리 동작 확인
4. 응답 시간 측정

**예상 결과:**
- ✅ 모든 API 2초 이내 응답
- ✅ JSON 스키마 일치
- ✅ 적절한 HTTP 상태 코드
- ✅ 오류 시 사용자 친화적 메시지

#### 6.2 데이터 동기화 테스트
**시나리오 ID:** TC-P2-014  
**목적:** 다중 탭/세션 간 데이터 동기화 확인

**테스트 단계:**
1. 동일 사용자 2개 탭으로 로그인
2. 한 탭에서 별의모래 획득
3. 다른 탭에서 새로고침 후 동기화 확인
4. 한 탭에서 상점 구매 후 다른 탭 확인

**예상 결과:**
- ✅ 실시간 데이터 동기화
- ✅ 충돌 상황 적절한 처리
- ✅ 일관된 사용자 경험

### 7. Performance & Reliability 테스트

#### 7.1 메모리 성능 테스트
**시나리오 ID:** TC-P2-015  
**목적:** 동기부여 시스템 추가로 인한 성능 영향 측정

**측정 항목:**
- 초기 로딩 시간
- 메모리 사용량 변화
- 애니메이션 프레임 레이트
- API 응답 시간

**성능 기준:**
- ✅ 초기 로딩: < 3초
- ✅ 메모리 증가: < 15MB
- ✅ 애니메이션: 60fps 유지
- ✅ API 응답: < 2초

#### 7.2 안정성 테스트
**시나리오 ID:** TC-P2-016  
**목적:** 장시간 사용 시 시스템 안정성 확인

**테스트 시나리오:**
- 연속 1시간 문제 풀이
- 상점 모달 반복 열기/닫기
- 네트워크 끊김 상황 대응

**예상 결과:**
- ✅ 메모리 누수 없음
- ✅ UI 응답성 유지  
- ✅ 오프라인 상황 적절한 처리

## 📋 리그레이션 테스트 (Phase 1 호환성)

### RT-001: 기존 게임플레이 영향 없음
- 모험 지도 → 문제 풀이 플로우 정상 동작
- 포켓몬 잡기 시스템 정상 동작
- 사용자 데이터 무손실

### RT-002: 기존 API 호환성 유지
- 문제 생성 API 정상 동작
- 답안 제출 API 정상 동작  
- 사용자 조회 API 정상 동작

### RT-003: UI 컴포넌트 호환성
- AdventureMap 컴포넌트 정상 렌더링
- ProblemCard 컴포넌트 정상 동작
- UserProfile 컴포넌트 정상 표시

## 🚨 롤백 조건

다음 중 하나라도 실패 시 Phase 2 기능을 비활성화하고 Phase 1으로 롤백:
1. **성능 저하**: 로딩 시간 3초 초과 또는 메모리 사용량 20MB 초과 증가
2. **API 실패율**: 동기부여 API 실패율 10% 초과
3. **UI 깨짐**: 핵심 게임플레이에 영향을 주는 UI 오류
4. **데이터 손실**: 기존 사용자 데이터 손실 또는 손상
5. **크리티컬 버그**: 게임 진행을 막는 치명적 오류

## 📝 테스트 실행 가이드

### 환경 설정
```bash
# 서버 실행
cd backend && npm run dev
cd frontend && npm run dev

# 테스트 사용자 생성 (다양한 상태)
curl -X POST http://localhost:3001/api/users \
  -H "Content-Type: application/json" \
  -d '{"nickname": "Phase2테스터"}'
```

### 테스트 실행 순서
1. **Streak System 테스트** (TC-P2-001 ~ TC-P2-003)
2. **Star Dust System 테스트** (TC-P2-004 ~ TC-P2-005)
3. **Badge System 테스트** (TC-P2-006 ~ TC-P2-007)
4. **Shop System 테스트** (TC-P2-008 ~ TC-P2-010)
5. **Visual Feedback 테스트** (TC-P2-011 ~ TC-P2-012)
6. **API Integration 테스트** (TC-P2-013 ~ TC-P2-014)
7. **Performance 테스트** (TC-P2-015 ~ TC-P2-016)
8. **리그레이션 테스트** (RT-001 ~ RT-003)

### 버그 리포팅 템플릿
```
**시나리오 ID:** TC-P2-XXX
**기능 영역:** Streak/StarDust/Badge/Shop/Visual/API/Performance
**재현 단계:** 
1. ...
2. ...
**예상 결과:** ...
**실제 결과:** ...
**환경:** Chrome/Safari/Firefox, macOS/Windows
**사용자 데이터:** {starDust: X, streak: Y, ...}
**스크린샷:** [첨부]
```

## 🎯 성공 기준

### Phase 2 개발 완료 조건
- ✅ 모든 테스트 시나리오 PASS (16/16)
- ✅ 리그레이션 테스트 PASS (3/3)  
- ✅ 성능 기준 만족
- ✅ 사용자 경험 개선 확인

### 품질 지표 목표
- **테스트 통과율**: 95% 이상
- **API 응답 시간**: 평균 1초 이내
- **메모리 사용량**: 기존 대비 15MB 이하 증가
- **사용자 만족도**: Phase 1 대비 개선

---
**테스트 계획 승인:** Phase 2 QA 팀  
**다음 단계:** 테스트 실행 및 QA 보고서 작성